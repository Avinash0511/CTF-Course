# Class 4

## Overview
In this lesson, we'll cover block ciphers and different block cipher modes. We'll also take a look at some attacks against poorly implemented block ciphers.

## Block Cipher
Block ciphers will take in a message of a fixed-length, your private key, and they produce a ciphertext of that length.

```python
from Crypto.Cipher import DES

key = '12345678' 			# Key must be 8 bytes (64 bits) long with DES
cipher = DES.new(key, DES.MODE_ECB)	# Create a DES cipher with my key

ct1 = cipher.encrypt('abcdefgh')	# DES will encrypt 8 bytes at a time
print repr(ct1)
>>> '\x94\xd4Ck\xc3\xb5\xb6\x93'

ct2 = cipher.encrypt('abcdefgh')	# The same 8 bytes will always encrypt to the same thing
print repr(ct2)
>>> '\x94\xd4Ck\xc3\xb5\xb6\x93'

ct3 = cipher.encrypt('hgfedbca')	# Different bytes will encrypt to different things
print repr(ct3)
>>> 'KKX\x8d\x86\xa4f]'

ct4 = cipher.encrypt('abcdefghabcdefgh')# What is we give it more than 8 bytes?
print repr(ct4)
>>> '\x94\xd4Ck\xc3\xb5\xb6\x93\x94\xd4Ck\xc3\xb5\xb6\x93'

ct5 = cipher.encrypt('abcdefghhgfedbca')
print repr(ct5)
>>>'\x94\xd4Ck\xc3\xb5\xb6\x93KKX\x8d\x86\xa4f]'
```

Look at **ct4** and **ct5** above. They show the essence of what a block cipher is. Block ciphers encrypt a **block** of data at a time. For DES, the block size is 8. You can check this with `DES.block_size`. For ct4, the first 8 bytes that are encrypted are 'abcdefgh', and the next 8 bytes that are encrypted are also 'abcdefgh', so for the output we get 8 encrypted bytes followed by the exact same 8 encrypted bytes. 

In other words, if `x`, `y`, and `z` are 8-byte strings, then `DES_encrypt(x+y+z) == DES_encrypt(x) + DES_encrypt(y) + DES_encrypt(z)`. This is only true for **Electronic Codebook** mode, or **ECB**, a block cipher mode. Block cipher modes define *how* multiple blocks are handles. In ECB mode, each block is just encrypted seperately. This is the weakest mode, and you might have some intuitation as to why. The same plaintext blocks will map to the same ciphertext blocks (when using the same key). This is sort of like a substitution cipher, but with blocks instead of single characters, and is susceptible to attacks.


## Challenge: Blocky
>**Talk to your neighbors about how to solve this problem without coding anything yet. Okay, now code it and get the flag.**




