# Class X: File and Memory Dump Forensics

## Magic Bytes
Every file format has magic bytes att the beginning of the data that helps your OS recognize how to read that data. Here's a quick cheat sheet for you to use.

| Format  | Bytes   | Hex  |
|---|---|---|
| .rar | Rar!\x1a\x07\x01\x00 | 52 61 72 21 1A 07 01 00 |
| pcap | ¡²ÃÔ | a1 b2 c3 d4 |
| ico | \x00\x00\x01\x00 | 00 00 01 00 |
| jpg | ÿØÿÛ | FF D8 FF DB |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
## What are memory dumps?
Memory dumps are created when the host device crashes. When your device crashes and says "gathering some info" it is creating a memory dump and sending it to Microsoft. In the world of cyber security, being able to parse and understand data from memory dumps is a valueable skill to have hence why it was converted into CTF problems.

## What tools will we be using?
For this course, we will teach Volatility. There may be other tools, but 99% of writeups on CTF-Time use this tool.
To install, open your Kali VM's terminal and type:
```
  pip install Volatility
```

## Getting Familiar with volatility
We're going to start on (OtterCTF.com's memory forensics challenges)[OtterCTF.com] in order to get used to using Volatility.

### House-keeping before we begin
These are a few steps you should always take when dealing with a memory-dump file.
```
volatility -f OtterCTF.vmem imageinfo
```
This will tell us what the suggested profile is that we should use.
### Problem 1
LSADump. Since this is a Windows 7 file, the password may be stored in the machine's LSA secrets.
```
volatility -f OtterCTF.vmem --profile=Win7SP1x64 lsadump
```
### Problem 2
```
volatility -f OtterCTF.vmem --profile=Win7SP1x64 netscan
```
This will allow us to find any local IP addresses
```
volatility -f OtterCTF.vmem --profile=Win7SP1x64 hivelist
volatility -f OtterCTF.vmem --profile=Win7SP1x64 printkey -o <Insert SYSTEM hive address here> -K 'ControlSet001\Control\ComputerName\ComputerName'
```
This will allow us to find the computer name
### Problem 4
```
volatility -f OtterCTF.vmem --profile=Win7SP1x64 memdump -p 708 -d .
strings 708.dmp | grep -a Lunar\-3 -C 5
```
