# Class 16: Diffie-Hellman

## Overview
In this lesson we will go over the Diffie-Hellman key exchange algorithm. We will also take a look at a network capture of a Diffie-Hellman key exchange.


## Diffie-Hellman
Looking back at block ciphers, such as DES and AES, they use a shared secret key. Block ciphers use the same key to encrypt and decrypt, so If I have an encrypted message that I want you to decrypt, how do I share the secret key with you?

That's where Diffie-Hellman comes in! Diffie-Hellman allows two people to generate a shared secret together across s public channel, so that anyone listenting to the messages being sent across the channel will not be able to determine the secret.

The reason this works? The **Discrete Log** problem, similarly to RSA. Given the values of `A`, `g`, and `p`, with `A = g<sup>a</sup> mod p`, calculating the value of `a` is a hard problem.

### The Algorithm
**Alice**
---
* Alice, the initiator, generates a strong prime `p`
* Alice also generates a base `g`, which is usually just the number 2
* Alice generates a **private** random number `a` which shares no factors with `p`
* Alice calculates a **public** `A` with `A = g<sup>a</sup> mod p`
* Alice sends `(p, g, A)` to Bob, `a` is kept **private**

**Bob** 
---
* Bob receives `(p, g, A)` from Alice
* Bob generates a **private** random number `b` which shares no factors with `p`
* Bob calculates a **public** `B` with `B = g<sup>b</sup> mod p` and sends to Alice

**Calculating the Secret**
---
* With the `B` received from Bob, Alice computes the shared secret `s` with `s = B<sup>a</sup> mod p`
* With the `A` received from Alice, Bob computes the same shared secret `s` with `s = A<sup>b</sup> mod p`

`p`, `g`, `A`, and `B` are **public** values, and `a`, `b`, and `s` are **private** values.

Only Alice can compute `s = B<sup>a</sup> mod p` because only Alice knows `a`.

Only Bob can compute `s = A<sup>b</sup> mod p` because only Bob knows `b`.

And looking at `A` and `B`, `A = g<sup>a</sup> mod p` and `B = g<sup>b</sup> mod p`, so Alice is computing `s = (g<sup>b</sup>)<sup>a<sup>` and Bob is computing `s = (g<sup>a</sup>)<sup>b<sup>`.

`g<sup>ba<sup> = g<sup>ab<sup>`
